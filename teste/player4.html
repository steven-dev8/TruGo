<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ENTRAR EQUIPE JG2</title>
</head>
<body>
  <script>
      const socket = new WebSocket("ws://localhost:8080/ws");

      let idx = 0;

      let minhasJogadas = [];

      socket.onopen = () => {
        console.log("ConexÃ£o aberta");

        socket.send(JSON.stringify({
          type: "ENTRAR_SALA",
          nome: "Caua",
          idSala: "2020",
        }));

        socket.send(JSON.stringify({
          type: "ENTRAR_EQUIPE",
          idSala: "2020",
          TimeEscolhido: "TIME_01",
        }));
      };

      socket.onmessage = (e) => {
        const msg = JSON.parse(e.data);
                console.log("ðŸ“¨", e.data);

        if (msg.type === "MAO_RODADA") {
          minhasJogadas = msg.mao; // atualiza a mÃ£o quando receber
          idx = 0; // reseta o Ã­ndice quando a mÃ£o Ã© atualizada (opcional)
        }
        else if (msg.type === "SUA_VEZ") {
          if (idx === 0) {
            socket.send(JSON.stringify({
              type: "CHAMAR_ENVIDO",
              idSala: "2020",
            }));
            idx++;
          } else {
            const carta = minhasJogadas.shift(); // pega a prÃ³xima carta
          if (carta) {
            socket.send(JSON.stringify({
              type: "FAZER_JOGADA",
              idSala: "2020",
              cartaJogada: carta,
            }));
          }
          }
        }
        else if (msg.type === "RESPOSTA_APOSTA") {
          const carta = minhasJogadas.shift(); // pega a prÃ³xima carta
          if (carta) {
            socket.send(JSON.stringify({
              type: "FAZER_JOGADA",
              idSala: "2020",
              cartaJogada: carta,
            }));
          }
        } else if (msg.type === "APOSTA") {
          socket.send(JSON.stringify({
              type: "ACEITAR_APOSTA",
              idSala: "2020",
              tipoAposta: "RETRUCO",
              aceitar: true,
            }));
      }};


      socket.onclose = () => console.log("Socket fechado!");
  </script>
</body>
</html>
